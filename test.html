<span style="color:rgb(0,0,0);font-family:'宋体', SimSun;">#!/bin/bash<br>#====================================================<br># Author: lizhenliang - EMail:zhenliang369@163.com<br># Create Date: 2015-02-01<br># Description: cpu utilization monitor<br># blog:lizhenliang.blog.51cto.com<br>#====================================================<br>if [ `uname` != "Linux" ];then<br>        echo "check os not linux."<br>        exit 1<br>fi<br>which vmstat &>/dev/null<br>if [ $? -ne 0 ];then<br>        echo "vmstat command no found, please install procps package." <br>        exit 1<br>fi<br>##################################################<br>cpu_us=`vmstat | awk '{print $13}' | sed -n '$p'`<br>cpu_sy=`vmstat | awk '{print $14}' | sed -n '$p'`<br>cpu_id=`vmstat | awk '{print $15}' | sed -n '$p'`<br>cpu_wa=`vmstat | awk '{print $16}' | sed -n '$p'`   #等待I/0完成<br>cpu_sum=$(($cpu_us+$cpu_sy))<br>cpu_info()<br>{<br>echo "CPU_Sum : $cpu_sum% ( CPU_Use:${cpu_us}% , CPU_System:${cpu_sy}% )" <br>echo "CPU_Idle : ${cpu_id}%"<br>echo "CPU_Wait : ${cpu_wa}"<br>}<br>#cpu_info;<br>if [ $cpu_sum -ge 90 ];then<br>        echo "CPU utilization $cpu_sum." | mail -s "CPU Monitor" baojingtongzhi@163.com<br>fi<br></span>
