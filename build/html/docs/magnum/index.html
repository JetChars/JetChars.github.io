

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Magnum &mdash; JetChars alpha documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="JetChars alpha documentation" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> JetChars
          

          
          </a>

          
            
            
              <div class="version">
                0.1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../cloud_computing.html">Cloud Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws/index.html">AWS &#8211; Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws_vpn/index.html">Build VPN with AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Docker</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph.html">Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph_deploy.html">Ceph Deploy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../openstack/index.html">OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nova.html">Nova</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sahara/index.html">Sahara</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kvm_optimization/index.html">KVM Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devstack/index.html">DevStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devstack_dvr/index.html">DevStack with DVR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devstack_t13g/index.html">DevStack Trouble Shooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../o7k_docker/index.html">OpenStack &amp; Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../osp7_director.html">OpenStack Platform 7 Director</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hadoop/index.html">Hadoop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadoop_conf_tuning/index.html">Hadoop Configuration Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadoop_hibench/index.html">HiBench - The Hadoop BenchMark Suit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doopshot/index.html">DoopShot</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../linux/freebsd.html">FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/linux_disk.html">Linux Disk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/linux_doc.html">Documentation Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/linux_info.html">Get System Infos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/linux_net.html">Linux Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/linux_pkg.html">Linux Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/linux_virt.html">Virtualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/shell.html">Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/ubuntu.html">Ubuntu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pxe/index.html">PXE &#8211; Preboot Execution Enviriment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../screen/index.html">Screen - Full-screen window manager</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../git.html">Git &#8211; Extraordinary version contrl software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../github/index.html">GitHub &#8211; Git repository hosting service</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../regex/index.html">Regular Expression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql/index.html">SQL &#8211; Structured Query Language</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rst.html">reStructured Text (rst)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../md.html">MarkDown (md)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../svg/index.html">Scalable Vector Graphics (SVG)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../netease_homework/os.html">Operating System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sort.html">Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_structure.html">Review DataStructure with Pics</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../amqp/index.html">AMQP &#8211; Advanced Message Queuing Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rest/index.html">RESTful API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../microservices/index.html">MicroServices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows/index.html">Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mac.html">Mac as Main OS</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kickstart/index.html">Kickstart Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">JetChars</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Magnum</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/docs/magnum/index.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="magnum">
<h1>Magnum<a class="headerlink" href="#magnum" title="Permalink to this headline">¶</a></h1>
<p>Magnum is an OpenStack project which offers container orchestration engines for deploying and managing containers as first class resources in OpenStack.[#]_
Containers started by Magnum are run on top of Nova instances that are created using Heat.
Pack applications together more tightly than would be possible using Virtual Machines.</p>
<ul class="simple">
<li>Bay: A collection of node objects where work is scheduled</li>
<li>BayModel: An object stores template information about the bay which is used to create new bays consistently</li>
<li>Node: A baremetal or virtual machine where work executes</li>
<li>Pod: A collection of containers running on one physical or virtual machine</li>
<li>Service: An abstraction which defines a logical set of pods and a policy by which to access them</li>
<li>ReplicationController: An abstraction for managing a group of pods to ensure a specified number of resources are running</li>
<li>Container: A Docker container</li>
</ul>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Configure</span>
<span class="c1"># ---------</span>
<span class="nv">ADMIN_PASSWORD</span><span class="o">=</span>123456

<span class="c1"># Get Admin Credit</span>
<span class="c1"># ----------------</span>
<span class="nb">source</span> ~/devstack/openrc admin admin
<span class="c1"># Magnum has been tested with the Fedora Atomic micro-OS and CoreOS. Magnum will likely work with other micro-OS platforms, but each requires individual support in the heat template.</span>
<span class="c1"># Store the Fedora Atomic micro-OS in glance. (The steps for updating Fedora Atomic images are a bit detailed. Fortunately one of the core developers has made Atomic images available at https://fedorapeople.org/groups/magnum):</span>

<span class="nb">cd</span> ~
wget https://fedorapeople.org/groups/magnum/fedora-21-atomic-3.qcow2
glance image-create --name fedora-21-atomic-3 <span class="se">\</span>
                    --is-public True <span class="se">\</span>
                    --disk-format qcow2 <span class="se">\</span>
                    --property <span class="nv">os_distro</span><span class="o">=</span><span class="s1">&#39;fedora-atomic&#39;</span><span class="se">\</span>
                    --container-format bare &lt; fedora-21-atomic-3.qcow2

<span class="c1"># Create a keypair for use with the baymodel:</span>
<span class="c1"># -------------------------------------------</span>
<span class="nb">test</span> -f ~/.ssh/id_rsa.pub <span class="o">||</span> ssh-keygen -t rsa -N <span class="s2">&quot;&quot;</span> -f ~/.ssh/id_rsa
nova keypair-add --pub-key ~/.ssh/id_rsa.pub testkey

<span class="c1"># Create a database in MySQL for magnum:</span>
<span class="c1"># --------------------------------------</span>
mysql -h 127.0.0.1 -u root -p<span class="nv">$ADMIN_PASSWORD</span> mysql <span class="s">&lt;&lt;EOF</span>
<span class="s">CREATE DATABASE IF NOT EXISTS magnum DEFAULT CHARACTER SET utf8;</span>
<span class="s">GRANT ALL PRIVILEGES ON magnum.* TO</span>
<span class="s">    &#39;root&#39;@&#39;%&#39; IDENTIFIED BY &quot;$ADMIN_PASSWORD&quot;</span>
<span class="s">EOF</span>

<span class="c1"># Clone and install magnum:</span>
<span class="c1"># -------------------------</span>
<span class="nb">cd</span> ~
git clone https://git.openstack.org/openstack/magnum
<span class="nb">cd</span> magnum
git checkout stable/kilo   <span class="c1"># should use same branch as current openstack</span>
sudo -E pip install -e .

<span class="c1"># Configure magnum:</span>
<span class="c1"># -----------------</span>
sudo mkdir -p /etc/magnum   <span class="c1"># create the magnum conf directory</span>
sudo cp etc/magnum/magnum.conf.sample /etc/magnum/magnum.conf   <span class="c1"># copy sample config and modify it as necessary</span>
sudo sed -i <span class="s2">&quot;s/#debug\s*=.*/debug=true/&quot;</span> /etc/magnum/magnum.conf   <span class="c1"># enable debugging output</span>
sudo sed -i <span class="s2">&quot;s/#verbose\s*=.*/verbose=true/&quot;</span> /etc/magnum/magnum.conf   <span class="c1"># enable more verbose output</span>
sudo sed -i <span class="s2">&quot;s/#rabbit_userid\s*=.*/rabbit_userid=stackrabbit/&quot;</span> <span class="se">\</span>
         /etc/magnum/magnum.conf   <span class="c1"># set RabbitMQ userid</span>
sudo sed -i <span class="s2">&quot;s/#rabbit_password\s*=.*/rabbit_password=</span><span class="nv">$ADMIN_PASSWORD</span><span class="s2">/&quot;</span> <span class="se">\</span>
         /etc/magnum/magnum.conf   <span class="c1"># set RabbitMQ password</span>
sudo sed -i <span class="s2">&quot;s/#connection\s*=.*/connection=mysql:\/\/root:</span><span class="nv">$ADMIN_PASSWORD</span><span class="s2">@localhost\/magnum/&quot;</span> <span class="se">\</span>
         /etc/magnum/magnum.conf   <span class="c1"># set SQLAlchemy connection string to connect to MySQL</span>
sudo sed -i <span class="s2">&quot;s/#admin_user\s*=.*/admin_user=admin/&quot;</span> <span class="se">\</span>
         /etc/magnum/magnum.conf   <span class="c1"># set Keystone account username</span>
sudo sed -i <span class="s2">&quot;s/#admin_password\s*=.*/admin_password=</span><span class="nv">$ADMIN_PASSWORD</span><span class="s2">/&quot;</span> <span class="se">\</span>
         /etc/magnum/magnum.conf   <span class="c1"># set Keystone account password</span>
sudo sed -i <span class="s2">&quot;s/#identity_uri\s*=.*/identity_uri=http:\/\/127.0.0.1:35357/&quot;</span> <span class="se">\</span>
         /etc/magnum/magnum.conf   <span class="c1"># set admin Identity API endpoint</span>
sudo sed -i <span class="s2">&quot;s/#auth_uri\s*=.*/auth_uri=http:\/\/127.0.0.1:5000\/v2.0/&quot;</span> <span class="se">\</span>
         /etc/magnum/magnum.conf   <span class="c1"># set public Identity API endpoint</span>

<span class="c1"># Clone and install the magnum client:</span>
<span class="c1"># ------------------------------------</span>
<span class="nb">cd</span> ~
git clone https://git.openstack.org/openstack/python-magnumclient
<span class="nb">cd</span> python-magnumclient
git checkout stable/kilo   <span class="c1"># should use same branch as current openstack</span>
sudo -E pip install -e .

<span class="c1"># Configure the database for use with magnum:</span>
<span class="c1"># -------------------------------------------</span>
magnum-db-manage upgrade

<span class="c1"># Configure the keystone endpoint:</span>
<span class="c1"># --------------------------------</span>
keystone service-create --name<span class="o">=</span>magnum <span class="se">\</span>
                        --type<span class="o">=</span>container <span class="se">\</span>
                        --description<span class="o">=</span><span class="s2">&quot;magnum Container Service&quot;</span>
keystone endpoint-create --service<span class="o">=</span>magnum <span class="se">\</span>
                         --publicurl<span class="o">=</span>http://127.0.0.1:9511/v1 <span class="se">\</span>
                         --internalurl<span class="o">=</span>http://127.0.0.1:9511/v1 <span class="se">\</span>
                         --adminurl<span class="o">=</span>http://127.0.0.1:9511/v1 <span class="se">\</span>
                         --region RegionOne
</pre></div>
</td></tr></table></div>
<div class="section" id="use-magnum">
<h2>use magnum<a class="headerlink" href="#use-magnum" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># infact it will create 3 nodes, include a swarm master node</span>
magnum bay-create --name swarmbay --baymodel swarmbaymodel --node-count 2
</pre></div>
</div>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><a class="reference external" href="http://docs.openstack.org/developer/magnum/index.html">http://docs.openstack.org/developer/magnum/index.html</a></td></tr>
</tbody>
</table>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, JetChars.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>