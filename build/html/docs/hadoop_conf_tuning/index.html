

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Hadoop Configuration Tuning &mdash; JetChars 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="JetChars 0.1 documentation" href="../../index.html"/>
        <link rel="next" title="Screen - Full-screen window manager" href="../screen/index.html"/>
        <link rel="prev" title="CentOS Tuning" href="../centos_tuning/index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../index.html" class="icon icon-home"> JetChars
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../cloud_computing/index.html">Cloud Computing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cloud_computing/index.html#docker">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloud_computing/index.html#terminologies">Terminologies</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../devstack_quickstart/index.html">OpenStack installation with DevStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enable_dvr_with_devstack/index.html">Enable DVR with DevStack</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../enable_dvr_with_devstack/index.html#brief-intro">Brief Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enable_dvr_with_devstack/index.html#configure-network-node">Configure Network Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enable_dvr_with_devstack/index.html#configure-compute-node">Configure Compute Node</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../openstack/index.html">OpenStack</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../openstack/index.html#id1">nova-docker</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kvm_optimization/index.html">KVM Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../kvm_optimization/index.html#disk">Disk</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kvm_optimization/index.html#asynchronous-io">Asynchronous IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kvm_optimization/index.html#disk-cache-mode">Disk Cache Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kvm_optimization/index.html#storage-backend">Storage Backend</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kvm_optimization/index.html#memory">Memory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kvm_optimization/index.html#drop-memory-cache">Drop Memory Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kvm_optimization/index.html#hugepages">HugePages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../kvm_optimization/index.html#check-hugepage-status">Check HugePage status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../kvm_optimization/index.html#enable-1gb-hugepage">Enable 1GB HugePage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../kvm_optimization/index.html#anonymous-hugepages-ahp">Anonymous HugePages (AHP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../kvm_optimization/index.html#transparent-hugepages-thp">Transparent HugePages(THP)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kvm_optimization/index.html#network">Network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kvm_optimization/index.html#mtu-size">MTU Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kvm_optimization/index.html#turn-off-nic-s-offloads">Turn off NIC&#8217;s offloads</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kvm_optimization/index.html#improve-instance-s-launch-speed">Improve Instance&#8217;s Launch Speed</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../hibench_intro/index.html">HiBench - The Hadoop BenchMark Suit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hibench_intro/index.html#what-is-hibench">What is HiBench?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hibench_intro/index.html#benchmark-types">BenchMark Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hibench_intro/index.html#configuration-running-scripts">Configuration &amp; Running scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hibench_intro/index.html#default-configurations">Default Configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../hibench_intro/index.html#dfsioe">DFSIOE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hibench_intro/index.html#sort">Sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hibench_intro/index.html#wordcount">WordCount</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hibench_intro/index.html#k-means">k-means</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../centos_tuning/index.html">CentOS Tuning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../centos_tuning/index.html#unlimit-non-root-user-s-resources">Unlimit Non-root User&#8217;s Resources</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Hadoop Configuration Tuning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rack-awareness">Rack Awareness</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#assumption">Assumption</a></li>
<li class="toctree-l3"><a class="reference internal" href="#replica-placement">Replica Placement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-new-block">Creating New Block</a></li>
<li class="toctree-l4"><a class="reference internal" href="#replicate-existing-block">Replicate Existing Block</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#topology-script">Topology Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-whether-rack-awareness-is-enabled">Check whether rack awareness is enabled</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#check-hdfs-topology-info">Check hdfs topology info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-replica-placement">Check replica placement</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hadoop-virtualization-extension-hve">Hadoop Virtualization Extension(HVE)</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../screen/index.html">Screen - Full-screen window manager</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../screen/index.html#command-list">Command List</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../screen/index.html#commands-out-of-screen">Commands out of screen</a></li>
<li class="toctree-l3"><a class="reference internal" href="../screen/index.html#commands-inside-screen">Commands inside screen</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../screen/index.html#shortcuts-keys">Shortcuts Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../screen/index.html#configuration-files">Configuration Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../string_process/index.html">String Processing Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../string_process/index.html#regular-expression">Regular Expression</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../string_process/index.html#basic-regular-express">Basic Regular Express</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../string_process/index.html#grep-globally-search-a-regular-expression-and-print">grep &#8211; Globally search a Regular Expression and Print</a></li>
<li class="toctree-l2"><a class="reference internal" href="../string_process/index.html#awk-pattern-directed-scanning-and-processing">awk &#8211; pattern-directed scanning and processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../string_process/index.html#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../string_process/index.html#predefined-variables">Predefined variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../string_process/index.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../string_process/index.html#sed-stream-editor">sed &#8211; stream editor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../string_process/index.html#id1">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../string_process/index.html#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../string_process/index.html#id2">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../documentation_tools/index.html">Linux Documentation Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../documentation_tools/index.html#sphinx-python-document-generator">Sphinx - Python Document Generator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation_tools/index.html#issues">Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation_tools/index.html#pandoc-universal-document-converter">Pandoc - Universal document converter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../network_tools/index.html">Network Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../network_tools/index.html#django-web-framework">Django &#8211; web framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network_tools/index.html#open-vswitch">Open vSwitch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network_tools/index.html#home-made-proxy-setting-tool">Home made proxy setting tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../virtualization/index.html">Virtualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../virtualization/index.html#hypervisors">Hypervisors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../virtualization/index.html#libvirt">Libvirt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../virtualization/index.html#virsh-virtualization-management-interface">Virsh &#8211; Virtualization Management Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../virtualization/index.html#docker">Docker</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../git/index.html">Git &#8211; Extraordinary version contrl software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../git/index.html#git-proxy-command">Git Proxy Command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../github/index.html">GitHub &#8211; Git repository hosting service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../github/index.html#github-com">github.com</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../github/index.html#shortcuts">shortcuts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../github/index.html#search-engine">search engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../github/index.html#url-customization">url customization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../github/index.html#github-io-github-pages">github.io &#8211; github pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../github/index.html#git-io-short-addr-service">git.io &#8211; short addr service</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rst/index.html">ReStructured Text (reST)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../rst/index.html#standard-rst">Standard rST</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../rst/index.html#inline-mark">Inline mark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rst/index.html#photos">Photos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rst/index.html#sidebar">SideBar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rst/index.html#html">HTML</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rst/index.html#maths-equttions-w-latex">Maths &amp; Equttions w/ LaTeX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rst/index.html#sphinx-customized-rst">Sphinx Customized rST</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../rst/index.html#table-of-content-tree-toctree">Table of Content Tree (toctree)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rst/index.html#paragraph-mark">Paragraph Mark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rst/index.html#code-block">Code Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rst/index.html#intersect-index">Intersect Index</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../rst/index.html#download">Download</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../md/index.html">MarkDown</a></li>
<li class="toctree-l1"><a class="reference internal" href="../svg/index.html">Scalable Vector Graphics (SVG)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../svg/index.html#resources">Resources</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">JetChars</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Hadoop Configuration Tuning</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/docs/hadoop_conf_tuning/index.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="hadoop-configuration-tuning">
<h1>Hadoop Configuration Tuning<a class="headerlink" href="#hadoop-configuration-tuning" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p><a class="reference external" href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/releasenotes.html">Hadoop 2.6.0 Release Note</a></p>
<div class="section" id="rack-awareness">
<h2>Rack Awareness<a class="headerlink" href="#rack-awareness" title="Permalink to this headline">¶</a></h2>
<p>Typically large Hadoop clusters are arranged in racks and network traffic between different nodes with in the same rack is much more desirable than network traffic across the racks. In addition NameNode tries to place replicas of block on multiple racks for improved fault tolerance. Hadoop lets the cluster administrators decide which rack a node belongs to through configuration variable <code class="docutils literal"><span class="pre">net.topology.script.file.name</span></code>. When this script is configured, each node runs the script to determine its rack id. A default installation assumes all the nodes belong to the same rack. This feature and configuration is further described in PDF attached to <a class="reference external" href="https://issues.apache.org/jira/browse/HADOOP-692">HADOOP-692</a></p>
<img alt="../../_images/network_topology.png" src="../../_images/network_topology.png" />
<ul class="simple">
<li>distance(/D1/R1/H1,/D1/R1/H1)=0  same datanode</li>
<li>distance(/D1/R1/H1,/D1/R1/H2)=2  same rack different datanode</li>
<li>distance(/D1/R1/H1,/D1/R1/H4)=4  same DataCenter different rack</li>
<li>distance(/D1/R1/H1,/D2/R3/H7)=6  different DataCenter</li>
</ul>
<div class="section" id="assumption">
<h3>Assumption<a class="headerlink" href="#assumption" title="Permalink to this headline">¶</a></h3>
<p>Bandwidth in/out of a subtree may be less than the total bandwidth of machines within the subtree.</p>
</div>
<div class="section" id="replica-placement">
<h3>Replica Placement<a class="headerlink" href="#replica-placement" title="Permalink to this headline">¶</a></h3>
<p>The block replica placement policy is intended to get a tradeoff between <code class="docutils literal"><span class="pre">minimizing</span> <span class="pre">the</span> <span class="pre">write</span> <span class="pre">cost</span></code> and <code class="docutils literal"><span class="pre">maximizing</span> <span class="pre">data</span> <span class="pre">reliability</span> <span class="pre">and</span> <span class="pre">availability,</span> <span class="pre">and</span> <span class="pre">aggregate</span> <span class="pre">read</span> <span class="pre">bandwidth</span></code>.</p>
<div class="section" id="creating-new-block">
<h4>Creating New Block<a class="headerlink" href="#creating-new-block" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">First replica on local node</p>
</li>
<li><p class="first">Second replica on different node at same rack</p>
</li>
<li><p class="first">Third replica on different node at different rack</p>
</li>
<li><dl class="first docutils">
<dt>Other replicas follow the rules below</dt>
<dd><ul class="first last simple">
<li>Each node has at most one replica</li>
<li>If replicas are less than racks*2, no more than 2 replicas on the same rack</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="replicate-existing-block">
<h4>Replicate Existing Block<a class="headerlink" href="#replicate-existing-block" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>If one replica exists, put 2nd replica on different rack</li>
<li>If two replicas on same rack, put 3rd replica on different rack</li>
<li>If two replicas on different racks, put 3rd replica on the same rack with replica 1</li>
<li>If there are more than 3 available replicas, then put other replicas randomly.</li>
</ul>
</div>
</div>
<div class="section" id="topology-script">
<h3>Topology Script<a class="headerlink" href="#topology-script" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Add parameter <code class="docutils literal"><span class="pre">net.topology.script.file.name</span></code> to <strong>core-site.xml</strong></li>
</ul>
<div class="sidebar">
<p class="first sidebar-title">Note</p>
<p class="last">The script name that should be invoked to resolve DNS names to NetworkTopology names. Example: the script would take host.foo.bar as an argument, and return /rack1 as the output.</p>
</div>
<ul class="simple">
<li>Write script file</li>
</ul>
<p><em>Sample c script</em></p>
<div class="highlight-c"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span> <span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span> <span class="p">;</span><span class="n">i</span><span class="o">&lt;</span> <span class="n">argc</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">char</span><span class="o">*</span> <span class="n">ipStr</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;/rack1/&quot;</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="o">&lt;&lt;</span><span class="s">&quot; &quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><em>Sample python script</em></p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">join</span>

<span class="n">DEFAULT_RACK</span> <span class="o">=</span> <span class="s">&#39;/default/rack0&#39;</span><span class="p">;</span>
<span class="n">RACK_MAP</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;10.72.10.1&#39;</span> <span class="p">:</span> <span class="s">&#39;/datacenter0/rack0&#39;</span><span class="p">,</span>
<span class="s">&#39;10.112.110.26&#39;</span> <span class="p">:</span> <span class="s">&#39;/datacenter1/rack0&#39;</span><span class="p">,</span>
<span class="s">&#39;10.112.110.27&#39;</span> <span class="p">:</span> <span class="s">&#39;/datacenter1/rack0&#39;</span><span class="p">,</span>
<span class="s">&#39;10.112.110.28&#39;</span> <span class="p">:</span> <span class="s">&#39;/datacenter1/rack0&#39;</span><span class="p">,</span>
<span class="s">&#39;10.2.5.1&#39;</span> <span class="p">:</span> <span class="s">&#39;/datacenter2/rack0&#39;</span><span class="p">,</span>
<span class="s">&#39;10.2.10.1&#39;</span> <span class="p">:</span> <span class="s">&#39;/datacenter2/rack1&#39;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">DEFAULT_RACK</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">join</span><span class="p">([</span><span class="n">RACK_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">DEFAULT_RACK</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]],</span><span class="s">&quot; &quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><em>Sample bash shell script</em></p>
<div class="highlight-shell"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="nv">HADOOP_CONF</span><span class="o">=</span>/etc/hadoop/conf

<span class="k">while</span> <span class="o">[</span> <span class="nv">$# </span>-gt <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">do</span>
    <span class="nv">nodeArg</span><span class="o">=</span><span class="nv">$1</span>
    <span class="nb">exec</span>&lt; <span class="si">${</span><span class="nv">HADOOP_CONF</span><span class="si">}</span>/topology.data
    <span class="nv">result</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="k">while</span> <span class="nb">read </span>line <span class="p">;</span> <span class="k">do</span>
        <span class="nv">ar</span><span class="o">=(</span> <span class="nv">$line</span> <span class="o">)</span>
        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">ar</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="nv">$nodeArg</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
            <span class="nv">result</span><span class="o">=</span>”<span class="si">${</span><span class="nv">ar</span><span class="p">[1]</span><span class="si">}</span>”
        <span class="k">fi</span>
    <span class="k">done</span>
    <span class="nb">shift</span>
<span class="nb">    </span><span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$result</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> -n <span class="s2">&quot;/default/rack &quot;</span>
    <span class="k">else</span>
        <span class="nb">echo</span> -n <span class="s2">&quot;</span><span class="nv">$result</span><span class="s2"> &quot;</span>
    <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</td></tr></table></div>
<div class="sidebar">
<p class="first sidebar-title">Important !</p>
<p class="last"><strong>topology data</strong> need to contain hostname, hostname.region, IP of each node.</p>
</div>
<p>Topology data</p>
<div class="highlight-python"><div class="highlight"><pre>hadoopdata1.ec.com     /dc1/rack1
hadoopdata1            /dc1/rack1
10.1.1.1               /dc1/rack2
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="check-whether-rack-awareness-is-enabled">
<h3>Check whether rack awareness is enabled<a class="headerlink" href="#check-whether-rack-awareness-is-enabled" title="Permalink to this headline">¶</a></h3>
<div class="section" id="check-hdfs-topology-info">
<h4>Check hdfs topology info<a class="headerlink" href="#check-hdfs-topology-info" title="Permalink to this headline">¶</a></h4>
<div class="highlight-shell"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="nv">$ </span>hadoop dfsadmin -report
Name: 172.16.0.4:50010 <span class="o">(</span>172.16.0.4<span class="o">)</span>
Hostname: r16s04
Rack: /dc1/rack16
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="check-replica-placement">
<h4>Check replica placement<a class="headerlink" href="#check-replica-placement" title="Permalink to this headline">¶</a></h4>
<div class="highlight-shell"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="nv">$ </span>hdfs dfs -cat /HiBench/benchmarks/TestDFSIO-Enh/_merged_reports.txt
/HiBench/benchmarks/TestDFSIO-Enh/io_write/part-00000 <span class="m">414033800</span> bytes, <span class="m">4</span> block<span class="o">(</span>s<span class="o">)</span>:  OK
0. BP-2107384216-192.168.16.3-1432011436876:blk_1073752772_11948 <span class="nv">len</span><span class="o">=</span><span class="m">134217728</span> <span class="nv">repl</span><span class="o">=</span><span class="m">3</span> <span class="o">[</span>/dc1/rack16/node2/172.16.0.2:50010, /dc1/rack16/node3/172.16.0.3:50010, /dc1/rack16/node4/172.16.0.4:50010<span class="o">]</span>
1. BP-2107384216-192.168.16.3-1432011436876:blk_1073752773_11949 <span class="nv">len</span><span class="o">=</span><span class="m">134217728</span> <span class="nv">repl</span><span class="o">=</span><span class="m">3</span> <span class="o">[</span>/dc1/rack16/node3/172.16.0.3:50010, /dc1/rack16/node1/172.16.0.1:50010, /dc1/rack16/node2/172.16.0.2:50010<span class="o">]</span>
2. BP-2107384216-192.168.16.3-1432011436876:blk_1073752774_11950 <span class="nv">len</span><span class="o">=</span><span class="m">134217728</span> <span class="nv">repl</span><span class="o">=</span><span class="m">3</span> <span class="o">[</span>/dc1/rack16/node2/172.16.0.2:50010, /dc1/rack16/node3/172.16.0.3:50010, /dc1/rack16/node4/172.16.0.4:50010<span class="o">]</span>
3. BP-2107384216-192.168.16.3-1432011436876:blk_1073752775_11951 <span class="nv">len</span><span class="o">=</span><span class="m">11380616</span> <span class="nv">repl</span><span class="o">=</span><span class="m">3</span> <span class="o">[</span>/dc1/rack16/node2/172.16.0.2:50010, /dc1/rack16/node1/172.16.0.1:50010, /dc1/rack16/node3/172.16.0.3:50010<span class="o">]</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
<div class="section" id="hadoop-virtualization-extension-hve">
<h2>Hadoop Virtualization Extension(HVE)<a class="headerlink" href="#hadoop-virtualization-extension-hve" title="Permalink to this headline">¶</a></h2>
<p>HVE is a new feature that extends the Hadoop topology awareness mechanism to account for the virtualization layer and refine data-locality-related policies. It is designed to enhance the reliability and performance of virtualized Hadoop clusters with extended topology layer and refined locality related policies. Test results documented in the following sections of this paper do show that reliability and performance can be optimized by taking advantage of this awareness of the virtualization topology.</p>
<div class="line-block">
<div class="line">HVE was developed by VMware engineers working with Apache Hadoop open source community, and the resulting patches have been contributed back to Apache Hadoop on trunk and branch-1. Umbrella JIRA <a class="reference external" href="https://issues.apache.org/jira/browse/HADOOP-8468">HADOOP-8468</a> tracks progress of this effort in the Apache community. <a class="footnote-reference" href="#id2" id="id1">[1]</a></div>
</div>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://www.vmware.com/files/pdf/Hadoop-Virtualization-Extensions-on-VMware-vSphere-5.pdf">http://www.vmware.com/files/pdf/Hadoop-Virtualization-Extensions-on-VMware-vSphere-5.pdf</a></td></tr>
</tbody>
</table>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../screen/index.html" class="btn btn-neutral float-right" title="Screen - Full-screen window manager" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../centos_tuning/index.html" class="btn btn-neutral" title="CentOS Tuning" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, JetChars.
    </p>
  </div>

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>