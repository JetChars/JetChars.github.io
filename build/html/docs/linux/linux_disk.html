

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Linux Disk &mdash; JetChars alpha documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="JetChars alpha documentation" href="../../index.html"/>
        <link rel="next" title="Documentation Tools" href="linux_doc.html"/>
        <link rel="prev" title="Linux Automizaiton Tools" href="linux_auto.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> JetChars
          

          
          </a>

          
            
            
              <div class="version">
                0.1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../cloud_computing.html">Cloud Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws/index.html">AWS &#8211; Amazon Web Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aws_vpn/index.html">Build VPN with AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Docker</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph.html">Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph_api.html">Ceph APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph_deploy.html">Ceph Deploy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph_issues.html">Ceph Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph_mgmt_platforms.html">Ceph Management Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph_mgmt_platforms_cn.html">Ceph 管理监控平台</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph_openstack.html">Ceph w/ OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph_ops.html">Ceph Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ceph/ceph_rest.html">Ceph RESTful API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../web/bootstrap.html">bootstrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web/html.html">HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web/httpd.html">Apache Httpd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web/rest.html">RESTful API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web/web.html">Web Server</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../openstack/index.html">OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nova.html">Nova</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sahara/index.html">Sahara</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kvm_optimization/index.html">KVM Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devstack/index.html">DevStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devstack_dvr/index.html">DevStack with DVR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devstack_t13g/index.html">DevStack Trouble Shooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../o7k_docker/index.html">OpenStack &amp; Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../osp7_director.html">OpenStack Platform 7 Director</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hadoop/index.html">Hadoop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadoop_conf_tuning/index.html">Hadoop Configuration Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadoop_hibench/index.html">HiBench - The Hadoop BenchMark Suit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doopshot/index.html">DoopShot</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dig.html">dig &#8211; Domain Information Groper</a></li>
<li class="toctree-l1"><a class="reference internal" href="freebsd.html">FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_auto.html">Linux Automizaiton Tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Linux Disk</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#filesystem">Filesystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kernnel-vfs">Kernnel &#8211; VFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fuse">FUSE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#driver">Driver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mke2fs">mke2fs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-fs-type">check fs type</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#devices">Devices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#storage-cards">Storage Cards</a></li>
<li class="toctree-l4"><a class="reference internal" href="#serial-devices">Serial Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-storage">Network Storage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mount">Mount</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mount-a-device">Mount a device</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unmount-a-device">Unmount a device</a></li>
<li class="toctree-l3"><a class="reference internal" href="#auto-mount">Auto Mount</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lvm-logical-volume-management">LVM &#8211; Logical volume management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#management">Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-lvm-infos">Check lvm infos</a></li>
<li class="toctree-l3"><a class="reference internal" href="#issues">Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#devicemapper">DeviceMapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#iscsi">iSCSI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tgtadm-linux-scsi-target-administration-utilit">tgtadm - Linux SCSI Target Administration Utilit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#loop-device">Loop Device</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sparse-file">Sparse File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#copying-w-cp">copying w/ &#8216;cp&#8217;</a></li>
<li class="toctree-l4"><a class="reference internal" href="#archiving-w-tar">Archiving w/ &#8216;tar&#8217;</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mount-sparse-file">Mount sparse file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#create-loop-device">Create Loop Device</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#raid">RAID</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#raid10">raid10</a></li>
<li class="toctree-l3"><a class="reference internal" href="#erasure-coding">Erasure Coding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#disk-performance">Disk Performance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dd-convert-and-copy-a-file">dd &#8211; convert and copy a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iozone">iozone</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="linux_doc.html">Documentation Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_info.html">Get System Infos</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_mon.html">Linux Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_net.html">Linux Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_pkg.html">Linux Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_virt.html">Virtualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell.html">Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="ubuntu.html">Ubuntu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pxe/index.html">PXE &#8211; Preboot Execution Enviriment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../screen/index.html">Screen - Full-screen window manager</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../git.html">Git &#8211; Extraordinary version contrl software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../github/index.html">GitHub &#8211; Git repository hosting service</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python/cython.html">Cython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/pelican.html">pelican</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/pep8.html">PEP8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/psdash.html">psdash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/py_apps.html">Python Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/py_builtin.html">Python Built-in Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/py_issues.html">Python Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/python.html">Python</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../regex/index.html">Regular Expression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql/index.html">SQL &#8211; Structured Query Language</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rst.html">reStructured Text (rst)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../md.html">MarkDown (md)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../svg/index.html">Scalable Vector Graphics (SVG)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../netease_homework/os.html">Operating System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sort.html">Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_structure.html">Review DataStructure with Pics</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../amqp/index.html">AMQP &#8211; Advanced Message Queuing Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../microservices/index.html">MicroServices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows/index.html">Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mac.html">Mac as Main OS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vim.html">Vim - My Favourite Editor</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kickstart/index.html">Kickstart Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">JetChars</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
    <li>Linux Disk</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/docs/linux/linux_disk.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="linux-disk">
<h1>Linux Disk<a class="headerlink" href="#linux-disk" title="Permalink to this headline">¶</a></h1>
<div class="sidebar">
<p class="first sidebar-title">e2fsprogs</p>
<p>e2fs programs, toolkits for maintaining ext2/3/4 filesystem</p>
<ul class="last simple">
<li><strong>mke2fs</strong> - create filesystem</li>
<li><strong>mkfs.ext{2,3,4}</strong> &#8211; quickly make a filesystem</li>
<li><strong>dumpe2fs</strong> &#8211; check filesystem info</li>
<li><strong>e2label</strong> &#8211; tag a device, for partition management <code class="docutils literal"><span class="pre">e2lable</span> <span class="pre">/dev/sdb1</span> <span class="pre">wenj</span></code></li>
<li><strong>e2fsck</strong> &#8211; check filesystem&#8217;s integrity</li>
<li><strong>resize2fs</strong> &#8211; autoresize filesystem size</li>
<li><strong>tune2fs</strong> &#8211; change filesystem related parameters</li>
<li><strong>debugfs</strong> &#8211; debug a filesystem, can check or change it&#8217;s status</li>
</ul>
</div>
<div class="section" id="filesystem">
<h2>Filesystem<a class="headerlink" href="#filesystem" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<div class="section" id="kernnel-vfs">
<h3>Kernnel &#8211; VFS<a class="headerlink" href="#kernnel-vfs" title="Permalink to this headline">¶</a></h3>
<p>Short for <strong>Virtual File System</strong>, or <strong>Virtual Filesystem Switch</strong>, maintain tree shaped linux filesystem</p>
<ul class="simple">
<li>It&#8217;s a glue level between storage media and filesystem, let system calls like <code class="docutils literal"><span class="pre">open()</span></code> <code class="docutils literal"><span class="pre">read()</span></code> <code class="docutils literal"><span class="pre">write()</span></code> don&#8217;t need to know to realize it in lower level</li>
<li>Sometimes short for <strong>Stackable Filesystem</strong> , because it can combine different filesystem seamlessly</li>
<li>Use command like <code class="docutils literal"><span class="pre">mount</span></code> to manage filesystem</li>
</ul>
</div>
<div class="section" id="fuse">
<h3>FUSE<a class="headerlink" href="#fuse" title="Permalink to this headline">¶</a></h3>
<p>Filesystem in Userspace(FUSE) is a <strong>software interface</strong> for <strong>Unix-like</strong> computer OS, let non priviledged users create their own FS w/o editing kernel code. <a class="footnote-reference" href="#id6" id="id1">[1]</a></p>
<ul class="simple">
<li>FUSE module provide a &#8220;bridge&#8221; to the actual kernel interface</li>
<li>In priciple, any resources available to a FUSE implementation can be explored as a FS</li>
</ul>
<a class="reference internal image-reference" href="../../_images/fuse_structure.png"><img alt="../../_images/fuse_structure.png" class="align-left" src="../../_images/fuse_structure.png" style="width: 300px;" /></a>
</div>
<div class="section" id="driver">
<h3>Driver<a class="headerlink" href="#driver" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span>ls /lib/modules/3.10.0-123.el7.x86_64/kernel/fs/
binfmt_misc.ko  dlm      fuse   mbcache.ko  pstore
btrfs           exofs    gfs2   nfs         squashfs
cachefiles      ext4     isofs  nfs_common  udf
cifs            fat      jbd2   nfsd        xfs
cramfs          fscache  lockd  nls
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">items</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>local</td>
<td>ext2/3/4</td>
</tr>
<tr class="row-odd"><td>network</td>
<td>sambafs/cifs/nfs/sshfs/gmailfs</td>
</tr>
<tr class="row-even"><td>cluster</td>
<td>gfs gfs2 ocfs</td>
</tr>
<tr class="row-odd"><td>distributed</td>
<td>HDFS mfs</td>
</tr>
</tbody>
</table>
<div class="section" id="mke2fs">
<h4>mke2fs<a class="headerlink" href="#mke2fs" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="29%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">option</th>
<th class="head">description</th>
<th class="head">examples</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>-t</td>
<td>specify filesys type</td>
<td>mke2fs -t ext4 /dev/sda3</td>
</tr>
<tr class="row-odd"><td>-b blocksize</td>
<td>specify block size</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>-c</td>
<td>check when creating filesys</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>-L label</td>
<td>specify volume label</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>-j</td>
<td>create journal system</td>
<td>ext2 doesn&#8217;t contain jornal ext3/4 built-in journal sys</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="check-fs-type">
<h4>check fs type<a class="headerlink" href="#check-fs-type" title="Permalink to this headline">¶</a></h4>
<div class="highlight-shell"><div class="highlight"><pre><span></span>df -T              <span class="c1"># check fs type of all devices</span>
df -T /dev/loop0   <span class="c1"># check fs type of specified device</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="devices">
<h3>Devices<a class="headerlink" href="#devices" title="Permalink to this headline">¶</a></h3>
<div class="section" id="storage-cards">
<h4>Storage Cards<a class="headerlink" href="#storage-cards" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">RAID/HBA</span></code></p>
</div>
<div class="section" id="serial-devices">
<h4>Serial Devices<a class="headerlink" href="#serial-devices" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">SATA</span></code> <code class="docutils literal"><span class="pre">SCSI</span></code> <code class="docutils literal"><span class="pre">SAS</span></code> <code class="docutils literal"><span class="pre">USB</span></code> name as <code class="docutils literal"><span class="pre">sd[a-z]</span></code></p>
</div>
<div class="section" id="network-storage">
<h4>Network Storage<a class="headerlink" href="#network-storage" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">SAN(Storage</span> <span class="pre">Area</span> <span class="pre">Network)</span></code></p>
</div>
</div>
</div>
<div class="section" id="mount">
<h2>Mount<a class="headerlink" href="#mount" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<div class="sidebar">
<p class="first sidebar-title">Note</p>
<p><strong>mount.ntfs</strong></p>
<p>ubuntu&#8217;s built-in NTFS driver, rhel/centos/fedora user need download <code class="docutils literal"><span class="pre">fuse-ntfs</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mount</span><span class="o">.</span><span class="n">ntfs</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdd</span> <span class="o">/</span><span class="n">mnt</span>
</pre></div>
</div>
<p><strong>fuser</strong></p>
<p>compared w/ lsof, fuser can check which process use folder or file exactly</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-v</span></code> show more details</li>
<li><code class="docutils literal"><span class="pre">-u</span></code> display user IDs</li>
<li><code class="docutils literal"><span class="pre">-l</span></code> show support signal list</li>
<li><code class="docutils literal"><span class="pre">-k</span> <span class="pre">-SIGNAL</span></code> send signal to all processes use this file</li>
</ul>
<table border="1" class="last docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">flag</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>c</td>
<td>as current folder</td>
</tr>
<tr class="row-odd"><td>e</td>
<td>as executable object</td>
</tr>
<tr class="row-even"><td>r</td>
<td>as root</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>as shared lib</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mount-a-device">
<h3>Mount a device<a class="headerlink" href="#mount-a-device" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span>mount [-t fstype] [-o mount_opt] device mountpoint
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Mount Options</strong> &#8211; seperate by comma</div>
<div class="line"><br /></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">option</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ro</td>
<td>readonly</td>
</tr>
<tr class="row-odd"><td>rw</td>
<td>read and write</td>
</tr>
<tr class="row-even"><td>remount</td>
<td>mount -o remount,ro /dev/sdb1 /mnt/</td>
</tr>
<tr class="row-odd"><td>sync</td>
<td>no use memcache</td>
</tr>
<tr class="row-even"><td>async</td>
<td>default option, use memcache</td>
</tr>
<tr class="row-odd"><td>atime</td>
<td>default option, record access time</td>
</tr>
<tr class="row-even"><td>noatime</td>
<td>not record access time</td>
</tr>
<tr class="row-odd"><td>acl</td>
<td>enable acl, must enabled if use acl</td>
</tr>
<tr class="row-even"><td>loop</td>
<td>mount iso file</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="unmount-a-device">
<h3>Unmount a device<a class="headerlink" href="#unmount-a-device" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ umount testlvm/ -f
umount: /root/testlvm: target is busy.
        (In some cases useful info about processes that use
         the device is found by lsof(8) or fuser(1))

$ fuser -m testlvm/
/root/testlvm:       24572c

$ ps aux | grep 24572
root      24572  0.0  0.0 117056  3924 pts/0    S+   May28   0:01 -bash
root     210760  0.0  0.0 112644   960 pts/41   S+   09:44   0:00 grep --color=auto 24572c

$ kill -9 24572
umount testlvm/    # umount object can be device or mount point
</pre></div>
</div>
</div>
<div class="section" id="auto-mount">
<h3>Auto Mount<a class="headerlink" href="#auto-mount" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">configure file <code class="docutils literal"><span class="pre">/etc/fstab</span></code> file system table:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mount</span> <span class="o">-</span><span class="n">a</span>  <span class="c1"># take effect fstab</span>
</pre></div>
</div>
</li>
<li><p class="first">mounted devices will be shown in <code class="docutils literal"><span class="pre">/etc/mtab</span></code>, same as cmd <code class="docutils literal"><span class="pre">mount</span></code></p>
</li>
</ul>
</div>
</div>
<div class="section" id="lvm-logical-volume-management">
<h2>LVM &#8211; Logical volume management<a class="headerlink" href="#lvm-logical-volume-management" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<div class="sidebar">
<p class="first sidebar-title">Terminologies</p>
<p>Every thing have an UUID</p>
<ul class="last simple">
<li><strong>PE</strong> &#8211; Physical Extend, smallest element, default size 4MB</li>
<li><strong>PV</strong> &#8211; Physical Volume</li>
<li><strong>VG</strong> &#8211; Volume Group</li>
<li><strong>LV</strong> &#8211; Logic Volume</li>
</ul>
</div>
<p>In computer storage, <em>logical volume management</em> or LVM provides a method of <em>allocating space</em> on mass-storage devices that is <em>more flexible</em> than conventional partitioning schemes. In particular, a volume manager can <strong>concatenate</strong>, <strong>stripe together</strong> or otherwise <strong>combine partitions</strong> (or block devices in general) into larger virtual ones that administrators can re-size or move, <em>potentially without interrupting system use</em>. <a class="footnote-reference" href="#id7" id="id2">[2]</a></p>
<ul class="simple">
<li>Conf-file &#8211; <code class="docutils literal"><span class="pre">/etc/lvm/lvm.conf</span></code></li>
</ul>
<div align="center" class="align-center"><img src="../../_images/lvm.svg" /></div>
<div class="section" id="management">
<h3>Management<a class="headerlink" href="#management" title="Permalink to this headline">¶</a></h3>
<div class="sidebar">
<p class="first sidebar-title">Note</p>
<p>/dev/vg0/lv0 &#8211;&gt; /dev/vg0-lv0</p>
<ul class="last simple">
<li>current version is <strong>lvm2</strong></li>
<li>check lvm version: <code class="docutils literal"><span class="pre">vgscan</span></code></li>
<li>convert LVMv1 to LVMv2: <code class="docutils literal"><span class="pre">vgconvert</span> <span class="pre">-M2</span> <span class="pre">vg0</span></code></li>
<li>rename VG vg0 to vg1: <code class="docutils literal"><span class="pre">vgrename</span> <span class="pre">vg0</span> <span class="pre">vg1</span></code></li>
</ul>
</div>
<ul class="simple">
<li>Create a Logic Volume: <code class="docutils literal"><span class="pre">pvcreate</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">vgcreate</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">lvcreate</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">mkfs.ext3</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">mount</span></code></li>
</ul>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>pvcreate /dev/sda5 dev/sda6
vgcreate vg0 /dev/sda5 /dev/sda6
lvcreate -L 800M -n lv0 vg0
mkfs.ext3 /dev/vg0/lv0
mount /dev/vg0/lv0 /mnt<span class="sb">``</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Delete a Logic Volume: <code class="docutils literal"><span class="pre">lvremove</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">vgremove</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">pvremove</span></code></li>
</ul>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span>lvremove lv0
vgremove vg0
pvremove /dev/sda5 dev/sda6
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Expand Logic Volume: <code class="docutils literal"><span class="pre">lvextend</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">resize2fs</span></code></li>
</ul>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># lvextend -L 1000M /dev/vg0/lv0    # extend to 1G</span>
lvextend -L +400M /dev/vg0/lv0     <span class="c1"># extend 400M</span>
resize2fs /mnt
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Reduce Logic Volume: <code class="docutils literal"><span class="pre">umount</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">e2fsck</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">resize2fs</span></code> &#8211;&gt; <code class="docutils literal"><span class="pre">lvreduce</span></code></li>
</ul>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>umount /mnt
e2fsck -f /dev/vg0/lv0
resize2fs /dev/vg0/lv0 180M   <span class="c1">#file system resize to a smaller size</span>
lvreduce -L 1000M /dev/vg0/lv0   <span class="c1">#reduce to 1000M</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Add PV: <code class="docutils literal"><span class="pre">vgextend</span></code></li>
</ul>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>pvcreate /dev/sda8
vgextend vg0 /dev/sda8
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Remove PV: <code class="docutils literal"><span class="pre">pvmove</span></code></li>
</ul>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># pvmove /dev/sda6:1-20 /dev/sda7   # will on move pe block 1-20 to sda7</span>
pvmove /dev/sda6   <span class="c1">#move PE to out of sda6(PV)</span>
vgreduce vg0 /dev/sda6   <span class="c1">#reduce one or more unused PV</span>
pvremove /dev/sda6
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="check-lvm-infos">
<h3>Check lvm infos<a class="headerlink" href="#check-lvm-infos" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">#</span> pvs
</span><span class="go">PV         VG                        Fmt  Attr PSize  PFree</span>
<span class="go">/dev/loop1 stack-volumes-default     lvm2 a--  10.01g 10.01g</span>
<span class="go">/dev/loop2 stack-volumes-lvmdriver-1 lvm2 a--  10.01g  8.00m</span>

<span class="hll"><span class="gp">#</span> vgs
</span><span class="go">VG                        #PV #LV #SN Attr   VSize  VFree</span>
<span class="go">stack-volumes-default       1   0   0 wz--n- 10.01g 10.01g</span>
<span class="go">stack-volumes-lvmdriver-1   1   1   0 wz--n- 10.01g  8.00m</span>

<span class="hll"><span class="gp">#</span> lvs
</span><span class="go">LV                                          VG                        Attr       LSize  Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert</span>
<span class="go">volume-c86ee1fc-0881-4b85-aa8a-432f8ad1c9cb stack-volumes-lvmdriver-1 -wi-ao---- 10.00g</span>

<span class="hll"><span class="gp">#</span> pvdisplay
</span><span class="go">--- Physical volume ---</span>
<span class="go">PV Name               /dev/loop1</span>
<span class="go">VG Name               stack-volumes-default</span>
<span class="go">PV Size               10.01 GiB / not usable 2.00 MiB</span>
<span class="go">Allocatable           yes</span>
<span class="go">PE Size               4.00 MiB</span>
<span class="go">Total PE              2562</span>
<span class="go">Free PE               2562</span>
<span class="go">Allocated PE          0</span>
<span class="go">PV UUID               dohGEH-212L-10Nb-wiWQ-mjZ4-ApKS-AchT26</span>

<span class="go">--- Physical volume ---</span>
<span class="go">PV Name               /dev/loop2</span>
<span class="go">VG Name               stack-volumes-lvmdriver-1</span>
<span class="go">PV Size               10.01 GiB / not usable 2.00 MiB</span>
<span class="go">Allocatable           yes</span>
<span class="go">PE Size               4.00 MiB</span>
<span class="go">Total PE              2562</span>
<span class="go">Free PE               2</span>
<span class="go">Allocated PE          2560</span>
<span class="go">PV UUID               UdQnN2-ddmJ-w3az-Gzp3-b7pf-tIFS-IB8Pho</span>

<span class="hll"><span class="gp">#</span> vgdisplay
</span><span class="go">--- Volume group ---</span>
<span class="go">VG Name               stack-volumes-default</span>
<span class="go">System ID</span>
<span class="go">Format                lvm2</span>
<span class="go">Metadata Areas        1</span>
<span class="go">Metadata Sequence No  1</span>
<span class="go">VG Access             read/write</span>
<span class="go">VG Status             resizable</span>
<span class="go">MAX LV                0</span>
<span class="go">Cur LV                0</span>
<span class="go">Open LV               0</span>
<span class="go">Max PV                0</span>
<span class="go">Cur PV                1</span>
<span class="go">Act PV                1</span>
<span class="go">VG Size               10.01 GiB</span>
<span class="go">PE Size               4.00 MiB</span>
<span class="go">Total PE              2562</span>
<span class="go">Alloc PE / Size       0 / 0</span>
<span class="go">Free  PE / Size       2562 / 10.01 GiB</span>
<span class="go">VG UUID               VWeopN-dnmk-W6Gg-byZE-JwRw-hndS-9xa5LU</span>

<span class="go">--- Volume group ---</span>
<span class="go">VG Name               stack-volumes-lvmdriver-1</span>
<span class="go">System ID</span>
<span class="go">Format                lvm2</span>
<span class="go">Metadata Areas        1</span>
<span class="go">Metadata Sequence No  2</span>
<span class="go">VG Access             read/write</span>
<span class="go">VG Status             resizable</span>
<span class="go">MAX LV                0</span>
<span class="go">Cur LV                1</span>
<span class="go">Open LV               1</span>
<span class="go">Max PV                0</span>
<span class="go">Cur PV                1</span>
<span class="go">Act PV                1</span>
<span class="go">VG Size               10.01 GiB</span>
<span class="go">PE Size               4.00 MiB</span>
<span class="go">Total PE              2562</span>
<span class="go">Alloc PE / Size       2560 / 10.00 GiB</span>
<span class="go">Free  PE / Size       2 / 8.00 MiB</span>
<span class="go">VG UUID               5TTHgC-LXzV-7i9u-YXnG-KQTY-HXmD-SFocsq</span>

<span class="hll"><span class="gp">#</span> lvdisplay
</span><span class="go">--- Logical volume ---</span>
<span class="go">LV Path                /dev/stack-volumes-lvmdriver-1/volume-c86ee1fc-0881-4b85-aa8a-432f8ad1c9cb</span>
<span class="go">LV Name                volume-c86ee1fc-0881-4b85-aa8a-432f8ad1c9cb</span>
<span class="go">VG Name                stack-volumes-lvmdriver-1</span>
<span class="go">LV UUID                KSvISz-D19i-13Ra-ZCVj-tkSa-dco6-uX7PJ2</span>
<span class="go">LV Write Access        read/write</span>
<span class="go">LV Creation host, time r16s12, 2015-05-28 16:35:27 +0800</span>
<span class="go">LV Status              available</span>
<span class="go">  open                 1</span>
<span class="go">LV Size                10.00 GiB</span>
<span class="go">Current LE             2560</span>
<span class="go">Segments               1</span>
<span class="go">Allocation             inherit</span>
<span class="go">Read ahead sectors     auto</span>
<span class="go">- currently set to     256</span>
<span class="go">Block device           253:0</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="issues">
<h3>Issues<a class="headerlink" href="#issues" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>remove vg after pv been removed</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span></span>$sudo vgremove r16s03-default
Incorrect metadata area header checksum on /dev/loop1 at offset 4096
vg_remove_mdas r16s03-default failed

$ sudo vgremove r16s03-default --force
/dev/loop1: lseek 4096 failed: Invalid argument
vg_remove_mdas r16s03-default failed
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Solution :</strong></div>
<div class="line"><br /></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo pvremove /dev/loop1 -ff
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>lvremove: Logical volume in use</li>
</ol>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ sudo lvremove /dev/r16s11-lvmdriver-1/volume-daffbf30-30b9-4da3-9d34-de1c658ee38c
Logical volume r16s11-lvmdriver-1/volume-daffbf30-30b9-4da3-9d34-de1c658ee38c in use.
$ sudo fuser /dev/r16s11-lvmdriver-1/volume-daffbf30-30b9-4da3-9d34-de1c658ee38c
/dev/dm-0:           159892
$ sudo <span class="nb">kill</span> -9 159892
$ sudo umount /dev/r16s11-lvmdriver-1/volume-daffbf30-30b9-4da3-9d34-de1c658ee38c
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Disk is apparently in use by the system</li>
</ol>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> mkfs.ext3 /dev/sdb1
<span class="go">mke2fs 1.39 (29-May-2006)</span>
<span class="go">/dev/sdb1 is apparently in use by the system; will not make a filesystem here!</span>
</pre></div>
</div>
<ul class="simple">
<li>Solution: remove the disk</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># dmsetup — low level logical volume management</span>
dmsetup remove /dev/sdb1
</pre></div>
</div>
</div>
</div>
<div class="section" id="devicemapper">
<h2>DeviceMapper<a class="headerlink" href="#devicemapper" title="Permalink to this headline">¶</a></h2>
</div>
<hr class="docutils" />
<div class="section" id="iscsi">
<h2>iSCSI<a class="headerlink" href="#iscsi" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<div class="section" id="tgtadm-linux-scsi-target-administration-utilit">
<h3>tgtadm - Linux SCSI Target Administration Utilit<a class="headerlink" href="#tgtadm-linux-scsi-target-administration-utilit" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># tgtadm</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="loop-device">
<h2>Loop Device<a class="headerlink" href="#loop-device" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>In Unix-like operating systems, a loop device, vnd (vnode disk), or lofi (loop file interface) is a pseudo-device that makes a file accessible as a block device. <a class="footnote-reference" href="#id8" id="id3">[3]</a></p>
<div class="section" id="sparse-file">
<h3>Sparse File<a class="headerlink" href="#sparse-file" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="../../_images/sparse_file.svg.png"><img alt="../../_images/sparse_file.svg.png" class="align-right" src="../../_images/sparse_file.svg.png" style="width: 260px;" /></a>
<p>Sparse file is a type of computer file that attempts to use file system space more efficiently when blocks allocated to the file are mostly empty. <a class="footnote-reference" href="#id9" id="id4">[4]</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This is achieved by writing brief information (metadata) representing the empty blocks to disk instead of the actual &#8220;empty&#8221; space which makes up the block, using less disk space.
When reading sparse files, the file system transparently converts metadata representing empty blocks into &#8220;real&#8221; blocks filled with zero bytes at runtime. The application is unaware of this conversion.</p>
<div class="sidebar">
<p class="first sidebar-title">du &#8211; display disk usage statistic(block usage)</p>
<table border="1" class="last docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">opts</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>-h</td>
<td>human readable format</td>
</tr>
<tr class="row-odd"><td>-T</td>
<td>print file system type</td>
</tr>
<tr class="row-even"><td>-t</td>
<td>limit file system type</td>
</tr>
</tbody>
</table>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> truncate -s 512M file1.img    <span class="c1"># notice 512M not same as 512MB</span>
<span class="gp">$</span> dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>file2.img <span class="nv">bs</span><span class="o">=</span><span class="m">1</span> <span class="nv">count</span><span class="o">=</span><span class="m">0</span> <span class="nv">seek</span><span class="o">=</span>512M
<span class="go">0+0 records in</span>
<span class="go">0+0 records out</span>
<span class="go">0 bytes (0 B) copied, 0.000173649 s, 0.0 kB/s</span>

<span class="gp">$</span> du -h file*   <span class="c1"># real size</span>
<span class="go">0       file1.img</span>
<span class="go">0       file2.img</span>
<span class="gp">$</span> du -h --apparent-size file*
<span class="go">512M    file1.img</span>
<span class="go">512M    file2.img</span>
<span class="gp">$</span> ll -h file*
<span class="go">-rw-r--r-- 1 root root 512M Jul 23 15:15 file1.img</span>
<span class="go">-rw-r--r-- 1 root root 512M Jul 23 15:15 file2.img</span>
</pre></div>
</div>
<div class="section" id="copying-w-cp">
<h4>copying w/ &#8216;cp&#8217;<a class="headerlink" href="#copying-w-cp" title="Permalink to this headline">¶</a></h4>
<p>Normally, &#8216;cp&#8217; is good at detecting whether a file is sparse.
Some cp implementations, like FreeBSD&#8217;s cp, do not support the <code class="docutils literal"><span class="pre">--sparse</span></code> option and will always expand sparse files</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="c1"># will create sparse file if src file is in sparse state</span>
cp file.img new_file.img
<span class="c1"># usful if a file containing long zero blocks is saved in a non-sparse way (will saving space)</span>
cp --sparse<span class="o">=</span>always new_file.img recovered_file.img
</pre></div>
</div>
</div>
<div class="section" id="archiving-w-tar">
<h4>Archiving w/ &#8216;tar&#8217;<a class="headerlink" href="#archiving-w-tar" title="Permalink to this headline">¶</a></h4>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> tar -Scf file.tar file.img   <span class="c1"># w/o &#39;-S&#39;, it will be 512M</span>
<span class="gp">#</span> du -h file.tar
<span class="go">12K     file.tar</span>
</pre></div>
</div>
</div>
<div class="section" id="mount-sparse-file">
<h4>Mount sparse file<a class="headerlink" href="#mount-sparse-file" title="Permalink to this headline">¶</a></h4>
<p>It can be either <strong>mounted as a loop device</strong>, or <strong>pretend to be an loop device</strong>.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> mkfs.reiserfs -f -q file.img
<span class="go">mkfs.reiserfs 3.6.21 (2009 www.namesys.com)</span>
<span class="gp">#</span> du -h file.img
<span class="go">33M     file.img</span>
<span class="gp">#</span> du -h --apparent-size file.img
<span class="go">512M    file.img</span>
<span class="gp">#</span> mkdir folder
<span class="gp">#</span> mount -o loop file.img folder
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-loop-device">
<h3>Create Loop Device<a class="headerlink" href="#create-loop-device" title="Permalink to this headline">¶</a></h3>
<ul>
<li><dl class="first docutils">
<dt>Setup loop device: <code class="docutils literal"><span class="pre">losetup</span> <span class="pre">[-o</span> <span class="pre">offset]</span> <span class="pre">[--sizelimit</span> <span class="pre">size]</span> <span class="pre">[-p</span> <span class="pre">pfd]</span> <span class="pre">[-rP]</span> <span class="pre">{-f[--show]|loopdev}</span> <span class="pre">file</span></code></dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">-show</span></code> will print device name</li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Get infos</span>
<span class="c1"># ---------</span>
losetup loopdev   <span class="c1"># show specified loopdev</span>
losetup -l <span class="o">[</span>-a<span class="o">]</span>   <span class="c1"># show loopdev list</span>
losetup -j file <span class="o">[</span>-o offset<span class="o">]</span>
losetup -f   <span class="c1"># Print first unused loop device</span>
<span class="c1"># management</span>
<span class="c1"># ----------</span>
losetup &lt;sparsefile&gt; /dev/loop<span class="o">{</span>num<span class="o">}</span>   <span class="c1"># create a loop device</span>
losetup -d loopdev...   <span class="c1"># Delete loop</span>
losetup -D   <span class="c1"># Delete all used loop devices</span>
losetup -c loopdev   <span class="c1"># Resize loop device</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="raid">
<h2>RAID<a class="headerlink" href="#raid" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<div class="section" id="raid10">
<h3>raid10<a class="headerlink" href="#raid10" title="Permalink to this headline">¶</a></h3>
<img alt="../../_images/raid10.jpg" class="align-right" src="../../_images/raid10.jpg" />
<p>Also called raid1+0, build raid1 first then use two raid 1 to build a raid0. different from raid 01.</p>
</div>
<div class="section" id="erasure-coding">
<h3>Erasure Coding<a class="headerlink" href="#erasure-coding" title="Permalink to this headline">¶</a></h3>
<p>Erasure Coding is a method of data protection in which data is broken into fragements that are expanded and encoded w/ a configurable number of redundant pieces and stored accross different locations. eg. disks, storage nodes or geographical locations <a class="footnote-reference" href="#id10" id="id5">[5]</a></p>
<ul class="simple">
<li>goal is to reconstruct corrupted by using infos about that data stored elsewhere.</li>
<li>works by creating a mathematical func to describe a set of numbers that they can be checked for accuracy and recovered if one is lost.</li>
<li>first used in CDs and DVDs, allows a player to calculate the correct information even though part of dice&#8217;s surface may be obsecured.</li>
<li>allows for the failure of two or more elements of a storage array.</li>
</ul>
</div>
</div>
<div class="section" id="disk-performance">
<h2>Disk Performance<a class="headerlink" href="#disk-performance" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<div class="section" id="dd-convert-and-copy-a-file">
<h3>dd &#8211; convert and copy a file<a class="headerlink" href="#dd-convert-and-copy-a-file" title="Permalink to this headline">¶</a></h3>
<p>The dd utility copies the standard input to the standard output.  Input data is read and written in 512-byte blocks.  If input reads are short, input from multiple reads are aggregated to form the output block.  When finished, dd displays the number of complete and partial input and output blocks and truncated input records to the standard error output.</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>bs=BYTES</td>
<td>read and write up to BYTES bytes at a time</td>
</tr>
<tr class="row-odd"><td>count=N</td>
<td>copy only N input blocks</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span>dd if=/dev/zero of=testfile bs=1M count=512 conv=fdatasync
</pre></div>
</div>
</div>
<div class="section" id="iozone">
<h3>iozone<a class="headerlink" href="#iozone" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span>dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>testfile <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">count</span><span class="o">=</span>8192
iozone -a -e -n 2g -g 8g -r 64k -i <span class="m">0</span> -i <span class="m">1</span> -i <span class="m">2</span> -i <span class="m">5</span> -f testfile -Rb ./iozone.xls
</pre></div>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace">https://en.wikipedia.org/wiki/Filesystem_in_Userspace</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Logical_volume_management">http://en.wikipedia.org/wiki/Logical_volume_management</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Loop_device">http://en.wikipedia.org/wiki/Loop_device</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><a class="reference external" href="https://wiki.archlinux.org/index.php/Sparse_file">https://wiki.archlinux.org/index.php/Sparse_file</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td><a class="reference external" href="http://www.computerweekly.com/feature/Erasure-coding-versus-RAID-as-a-data-protection-method">http://www.computerweekly.com/feature/Erasure-coding-versus-RAID-as-a-data-protection-method</a></td></tr>
</tbody>
</table>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="linux_doc.html" class="btn btn-neutral float-right" title="Documentation Tools" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="linux_auto.html" class="btn btn-neutral" title="Linux Automizaiton Tools" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, JetChars.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>